2009-11-17  Kerstin Paech  <paech@physik.uni-bonn.der>
	
	* lib/pySNIFS.py: removed the numarray/numpy switch. Fixed Mantis
	  issue #1331: pySNIFS produced corrupt e3d-fits-files for a
	  certain class of input-fits files due to mismatch between header
	  and data formats.

2009-11-13  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/e3dto3d.py: convertor from SNIFS Euro3D cubes to
	NAXIS=3 FITS cubes.

	* lib/pySNIFS.py (SNIFS_cube.WR_3d_fits): data cube is stored in
	primary extension, while variance is stored in 1st ('VARIANCE')
	extension. Euro3D cube header is propagated in output file.

2009-06-29  Yannick Copin  <ycopin@lbl.gov>

	* apps/extract_star/extract_star.py: remove call to S.degrees(),
	not available for python-2.4.

2009-06-10  Yannick Copin  <ycopin@lbl.gov>

	* apps/extract_star/extract_star.py: aperture radius (option
	'-r/--radius') for aperture-based methods can be specified in
	arcsec or in seeing sigmas. Plot updates.

2009-05-20  Yannick Copin  <ycopin@lyopc469>

	* apps/extract_star/extract_star.py (setPSF3Dconstraints): new
	expert option '--psf3Dconstraints' to specify constraints on PSF
	parameters during 3D-fit. Each parameter (0=delta, 1=theta,
	2,3=position, 4=PA, 5...6+ellDeg=ellipticity coeffs and
	7+ellDeg...8+ellDeg+alphaDeg=alpha coeffs) can be constrained
	individually strictly (e.g. '0:1' to force delta to 1) or loosely
	(e.g. '2:-1,1' to constrain x-position within +/-1). Note that
	constraints on polynomial coeffs have to be expressed as function
	of lr := (2*lambda - (lmin+lmax))/(lmax-lmin), while the coeffs
	stored in header keywords are for polynoms of lr := lambda/lref -
	1.

2009-03-31  Yannick Copin  <ycopin@lbl.gov>

	* apps/extract_star/extract_star.py: the so-called PA parameter of
	the PSF is not the PA of the adjusted ellipse, but half the x*y
	coefficient. Similarly, ell is not the ellipticity, but the y**2
	coefficient: x2 + ell*y2 + 2*PA*x*y + ... = 0. One should use
	quadEllipse for conversion, and use full covariance matrix to
	compute and plot associated errors.

2009-03-24  Yannick Copin  <ycopin@lbl.gov>

	* apps/extract_star/extract_star.py: plot updates.

2009-02-17  Yannick Copin  <ycopin@lbl.gov>

	* apps/extract_star/extract_star.py: new option '-V/--variance' to
	store variance spectrum as extension to signal spectrum.

	* lib/pySNIFS.py (spectrum.WR_fits_file): variance extension if
	any is named 'VARIANCE'.

	* apps/extract_star/extract_star.py: add binned points in radial
	plot.

2008-11-10  Yannick Copin  <ycopin@lyopc469>

	* apps/extract_star/extract_z.py: add detection level.

2008-11-07  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: use polynoms of (2*lbda -
	(lmin+lmax))/(lmax-lmin) internally to decrease covariance between
	coefficients. Keyword coeffs are converted to polynom of
	lbda/5000A-1 to ease inter-channel comparison.

	* lib/libExtractStar.py (polyConvert): polynomial utility to
	convert P(x) to P~(x~:=a+b*x).

2008-11-05  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_z.py: 
	* apps/extract_star/extract_star.py: covariance matrix is *twice*
	the invert of hessian for chi2-fit.

2008-11-03  Yannick Copin  <ycopin@lyopc469>

	* apps/extract_star/extract_z.py: split lines + background, add
	correlation matrix plot, store results in keywords.

2008-10-31  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_z.py: extract redshift on galaxy
	spectrum from [OII] or Halpha/[NII] (previously included in
	extract_host.py).

	* apps/extract_star/extract_host.py: remove redshift fitting, now
	in extract_z.py.

2008-10-31  Yannick Copin  <ycopin@lyopc469>

	* apps/extract_star/extract_host.py: extend max. redshift to 0.13
	(SNF20070912-000 is at ~0.12). 

2008-10-24  Yannick Copin  <ycopin@lyopc469>

	* apps/extract_star/extract_host.py: adjust mean redshift on
	galaxy spectrum from [OII] or [NII]/Halpha lines. Still
	experimental: velocity map.

2008-10-23  Yannick Copin  <ycopin@lyopc469>

	* lib/pySNIFS.py (SNIFS_cube.__init__): generate a
	'e3d_data_header' attribute in the fits3d_file case just for
	consistency.

	* apps/extract_star/extract_host.py: handle reference galaxy FITS
	3D-cubes from DDT (after a bit of massage).

2008-10-22  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_host.py: Simple host spectrum
	extraction on reference cube. Sky spectrum is estimated from bottom
	quartile, and galaxy+sky from top quartile.

2008-09-24  Yannick Copin  <ycopin@lyopc469>

	* apps/extract_star/extract_star.py (extract_spec): do not apply
	Laplacian filter prior to spectrum extraction (was causing Mantis
	#1282).

2008-06-23  Yannick Copin  <ycopin@lyopc469>

	* apps/extract_star/extract_star.py: now calls external
	libExtractStar.py.

	* lib/libExtractStar.py: ADR and PSF utilities externalized from
	extract_star.
					 
2008-06-20  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* lib/pySNIFS_fit.py (model.fit_bfgs): similar to model.fit but
	using S.optimize.fmin_l_bfgs_b as fit engine instead of
	S.optimize.fmin_tnc (for testing purpose, much slower than TNC).

	* lib/pySNIFS_fit.py (model.fit): debugging to accomodate scipy
	0.6.0 (reversed output order, buggy auto-offset).

	* setup.py (main): old extract_star2.py (2-gaussian PSF) not
	installed anymore.

2008-05-26  Emmanuel Pecontal

	* lib/pySNIFS.py : Allow to create a SNIFS_cube object from a 3D
	fits file

	* apps/extract_star : Test if the input datacube is a e3d or a
	fits3d file
	
2008-05-19  ClÃ©ment BUTON  <cbuton@bigbrother.dhcp.lbnl.us>

	* lib/pySNIFS_fit.py (model.fit): minor changes

	* apps/extract_star/PSF_analysis.py: same point source extractor
	than extract_star, except that all the PSF parameters can be 
	correlated or free. (based on extract_star 1.86)

	* lib/pySNIFS_fit.py (model.fit): Fmin_tnc's outputs inversion
	in the new version of scipy ('0.6.0').  

2008-05-13  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: long bug fighting session,
	lots of leftovers...

	* lib/pySNIFS_fit.py: rephrasing and optimizations.

2008-04-23  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* lib/pySNIFS.py (SNIFS_cube.WR_3d_fits): debugging.

	* apps/extract_star/extract_star.py: new option '--keepmodel' to store
	meta-slice model in 3D-cube.

2008-04-09  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: new radial chi2 plot
	(commented out).

	* apps/extract_star/convert_3DPSF.py: ad-hoc convertor from PSF
	3D-cube simulated by G.Rigaudier to Euro3D cube suitable for
	extract_star (requires IFU python wrapper IFU_py_io).

	* apps/extract_star/psf_sympy.py: toy script to check PSF model
	and derivatives under sympy.

2008-03-11  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: can now fit the PSF without
	any background ('-S -1').

2008-03-07  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: new cut for 'long exposure'
	above 12s.

2008-03-06  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: option '--supernova' now
	discards completely 3D fit.

2008-03-04  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: add FoV to ADR plot.

2008-03-03  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py (estimate_parangle): estimate
	parallactic angle from header if 'PARANG' keyword is missing.

2008-02-19  yannick.copin  <yannick.copin@laposte.net>

	* apps/extract_star/extract_star.py: test positivity of alpha and
	ellipticity after 3D fit.

2008-02-18  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py : add new option '-F' to
	create a log file with adjusted parameters of final 3D fit.

2008-02-13  yannick.copin  <yannick.copin@laposte.net>

	* apps/extract_star/extract_star.py: new meta-slice selection
	process from position at reference wavelength, updated graphics,
	new option '--supernova' to fix ADR and position in 3D fit
	(EXPERIMENTAL).

2008-02-11  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py (ExposurePSF.__init__): use
	'PRESSURE' and 'TEMP' estimates from cube keywords.

	* lib/pySNIFS.py (SNIFS_cube.__init__): self.e3d_data_header is
	now a plain dictionary (instead of a list of items [(key,value)]).

2008-02-04  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: Add new keywords and change
	the log file.

2008-01-28  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: debug initial guess for
	polynomial background, use constant ref. lambda (5000 A).

2008-01-23  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* lib/pySNIFS.py (SNIFS_cube.__init__): debug i,j spx coords
	computed from arcsec coords x,y.

2008-01-09  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: Minor changes.

	* lib/pySNIFS.py (fit_poly): Add a warning in fit_poly when number
	of point is not sufficient to make a fit.

2008-01-07  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py (fit_slices): Fit a 2D
	polynomial of degree skyDeg on the edge pixels of a given cube
	slice as guess of the slice by slice fit.

2008-01-06  yannick.copin  <yannick.copin@laposte.net>

	* apps/extract_star/extract_star.py (extract_spec): catch
	L.LinAlgError about singular matrix.

2007-12-20  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* lib/pySNIFS.py:
	* lib/pySNIFS_plot.py: pylab-related methods extracted from
	pySNIFS.py.

2007-12-05  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* lib/pySNIFS_fit.py (model.fit): reduced khi2 is khi2/DoF with
	DoF = N - P, N=nb of points, P=nb of parameters.
	(model.flat_param()): removed (was not working anyway...).

	* apps/extract_star/extract_star.py: ADR angle theta is now
	equivalent to parallactic angle.

2007-12-03  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py (polyfit_clip): add a maximum
	nb of iterations (could oscillate indefinitely between two
	configurations). Definite (hopefully) estimate of ADR angle
	theta (= parallactic angle - 90deg).

2007-11-30  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: extrapolate signal outside
	FoV when aperture hits edge (only in 'aperture' method). Some
	options renamed ('-d' to '-S', '-a' to '-A', '-e' to '-E').

2007-11-28  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: handle negative sky, raise an
	error when aperture hits FoV edges, optimal summation (using a
	variance sigma-clipped linear fit).

2007-11-23  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py (comp_spec): added a
	discussion about NNLS.

2007-11-22  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: new estimate of ADR angle.

2007-11-21  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: new option '-e/--ellDeg' to
	choose polynomial degree of ellipticity.

2007-11-19  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py (comp_spec): on the way to
	optimal extraction.

2007-11-16  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: implement plain aperture
	photometry (new option '-m/--method PSF|aperture'). Debug seeing
	estimate.

2007-11-16  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: build_sky_cube is now working
	normally.

2007-11-15  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: Add fwhm estimate.

2007-11-15  yannick.copin  <yannick.copin@laposte.net>

	* apps/extract_star/extract_star.py: debug of graphical
	options. Modifications (mainly in comp_spec) in preparation to
	aperture and optimal photometry.

2007-11-14  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: make both short_ and
	long_exposure_psf inherit from a ExposurePSF class. Normalize PSF
	from within psf.comp (new keyword normed).

2007-11-14  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* lib/pySNIFS_fit.py (fnnls): replace any(x) by x.any().

	* apps/extract_star/extract_star.py: Correct a bug related to the
	polynomial of the sky. Make the code robust.

2007-11-13  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: Correct minor bug. 

2007-11-12  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* lib/pySNIFS_fit.py (model.check_grad): new keyword param.

	* apps/extract_star/extract_star.py: force alpha to >0.

2007-11-09  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: Correct determination of
	theta_guest for the 3D fit.

2007-11-08  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: Change relative lambda in
	lambda/lambda_ref - 1.

2007-11-07  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: add an option to choose the
	polynomial degree of alpha.

2007-11-07  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py (comp_spec): check for
	negative variance.

2007-11-06  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: minor bug corrected.

2007-11-06  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* lib/pySNIFS.py: 
	* lib/pySNIFS_fit.py: namespace debugging.

2007-11-05  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* lib/pySNIFS.py: 
	* lib/pySNIFS_fit.py: "pythonication" and optimization.

2007-11-05  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star.py: back to a linear
	representation of alpha.

2007-10-29  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star_2.py: change names between
	extract_star.py (v 1.32) and extract_star_2.py (v 1.13).

	* apps/extract_star/extract_star.py: change names between
	extract_star.py (v 1.32) and extract_star_2.py (v 1.13).

2007-10-25  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star_2.py: bug in var_sky
	normalization corrected.
	
	* apps/extract_star/extract_star_2.py: sky spectra and var_sky
	spectra can now be read by quick_plot but !!! var_sky
	normalization is still false !!!

2007-10-23  yannick.copin  <yannick.copin@laposte.net>

	* apps/extract_star/extract_star_2.py: remove spectrum+/-2sigma
	plot (unreadble in low S/N, spline convergence issues). Still some
	normalization issues...

2007-10-23  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* apps/extract_star/extract_star_2.py: merge the polynomial
	background from extract_star.py (version 1.37).

2007-10-23  yannick.copin  <yannick.copin@laposte.net>

	* apps/extract_star/extract_star_2.py: add residual plot.

2007-10-22  Clement Buton  <cbuton@lyopc387.in2p3.fr>
	
	* apps/extract_star/extract_star_2.py: add short exposure psf
	function.

	* apps/extract_star/extract_star_2.py: modify the bounds.

	* apps/extract_star/extract_star_2.py: change alpha's
	parametrization from a1*lambda+a0 to a0*lambda^a1.

2007-10-20  yannick.copin  <yannick.copin@laposte.net>

	* apps/extract_star/extract_star_2.py: lots of (simplified)
	rewrites, now fits alpha = a0 + a1*(lbda-lbda_ref) to get a
	meaningful a0.

2007-10-19  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star_2.py: plot updates. Remove
	constraints on a0,a1 3D-fit.

2007-10-18  Clement Buton  <cbuton@lyopc387.in2p3.fr>

	* setup.py: add extract_star_2.py 

	* apps/extract_star/extract_star_2.py: New extractor based on
	extract_star with an empirical Gaussian+Moffat PSF function.

2007-10-18  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: discard NaNs in plots.

2007-07-05  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py (comp_spec): issue sky
	spectrum normalized to 'per arcsec^2' instead of 'per
	spaxel'. Minor plotting updates.

2007-06-19  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py (comp_spec): detect and handle
	null determinant, or explicitely crash if extraction fails.

2007-06-18  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: new contour plot, add seeing
	estimate keyword 'SEEING' (FWHM in arcsec).

2007-06-13  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: use less meta-slices for
	preliminary 2D fits, no more selection on meta-slices.

2007-06-11  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: new radial plot, spaxel size
	is 0.43 arcsec.

2007-06-01  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: some plot updates.

2007-05-08  yannick.copin  <yannick.copin@laposte.net>

	* apps/extract_star/extract_star.py: minor reformatting, fits I/O.

2006-10-19  yannick.copin  <yannick.copin@laposte.net>

	* lib/pySNIFS.py: use standard 'raise Exception(msg)',
	(SNIFS_mask.__init__): replace os.system calls by ad-hoc
	commands.getstatusoutput-based runCmd function, chmod 0444
	mask_copy before sel_table call.

2006-10-17  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	* setup.py: 
	* lib/pySNIFS.py: 
	* lib/pySNIFS_fit.py: Author and version tags.

2006-04-20  Yannick Copin  <yannick@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: minor changes.

2006-04-18  Yannick Copin  <yannick@ipnl.in2p3.fr>

	* apps/extract_star/extract_star.py: new option '--graph', rewrites.

2006-04-13  *************** pySNIFS-0-3 ***************

2006-04-13  Yannick Copin  <ycopin@ipnl.in2p3.fr>

	*  (Module): update from E.Pecontal's private version.

2006-04-13  *************** pySNIFS-0-2 ***************
